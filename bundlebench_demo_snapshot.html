<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>BundleBench Demo Snapshot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Chart.js Plugins (for bullet, treemap, etc.) -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-treemap@3.0.1/dist/chartjs-chart-treemap.min.js"></script>
  <style>
    :root {
      --bg: #0f172a;
      --panel: #1a2236;
      --line: rgba(255,255,255,0.08);
      --text: #e5e7eb;
      --muted: #94a3b8;
      --accent: #6366f1;
      --good: #10b981;
      --warn: #f59e0b;
      --bad: #ef4444;
      --elite: #6366f1;
      --radius: 14px;
      --tile-size: 18px;
    }
    html, body {
      background: linear-gradient(180deg, #0b1024, #0a0f20);
      color: var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      margin: 0;
      padding: 0;
    }
    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 30px;
    }
    h1, h2, h3, h4 {
      margin: 0 0 10px;
      font-weight: 700;
    }
    h1 { font-size: 2.2rem; }
    h2 { font-size: 1.5rem; }
    h3 { font-size: 1.1rem; color: var(--accent);}
    section {
      margin-bottom: 28px;
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: 0 2px 16px #0002;
      padding: 22px 22px 18px 22px;
      border: 1px solid var(--line);
    }
    .row {
      display: flex;
      gap: 18px;
      margin-bottom: 28px;
    }
    .tile {
      background: #1e293b;
      border-radius: 10px;
      padding: 18px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 220px;
      box-shadow: 0 1px 8px #0001;
      border: 1px solid var(--line);
      position: relative;
    }
    .kpi {
      font-size: 2.3rem;
      font-weight: 800;
      margin: 8px 0 0 0;
    }
    .badge {
      display: inline-block;
      font-size: 0.85em;
      border-radius: 8px;
      padding: 4px 12px;
      font-weight: 600;
      margin-top: 8px;
      background: #1e293b;
      border: 1px solid var(--line);
    }
    .badge.bad { background: var(--bad); color: #fff; }
    .badge.warn { background: var(--warn); color: #fff; }
    .badge.good { background: var(--good); color: #fff; }
    .badge.elite { background: var(--elite); color: #fff; }
    .viz {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 10px;
      margin-bottom: 8px;
    }
    .stacked-bar {
      width: 340px;
      height: 38px;
      background: #222d48;
      border-radius: 12px;
      display: flex;
      overflow: hidden;
      box-shadow: 0 1px 6px #0002;
      border: 1px solid var(--line);
      position: relative;
    }
    .bar-bundled { background: var(--good);}
    .bar-multiline { background: var(--warn);}
    .bar-single { background: var(--bad);}
    .bar-umbrella {
      position: absolute;
      top: 0; left: 0; height: 100%;
      background: repeating-linear-gradient(45deg, #6366f1 0 8px, #222d48 8px 16px);
      opacity: 0.7;
      pointer-events: none;
      z-index: 2;
      border-radius: 12px;
    }
    .target-band {
      position: absolute;
      top: 0; left: 0;
      height: 100%; width: 100%;
      z-index: 1;
      border-radius: 12px;
      pointer-events: none;
    }
    .waffle {
      display: grid;
      grid-template-columns: repeat(10, var(--tile-size));
      grid-template-rows: repeat(10, var(--tile-size));
      gap: 2px;
      margin: 12px auto 4px auto;
      width: calc(var(--tile-size) * 10 + 20px);
      justify-content: center;
    }
    .waffle-tile { width: var(--tile-size); height: var(--tile-size); border-radius: 4px; }
    .waffle-bundled { background: var(--good);}
    .waffle-multiline { background: var(--warn);}
    .waffle-single { background: var(--bad);}
    .waffle-umbrella { box-shadow: 0 0 0 2px var(--elite);}
    .treemap-legend { display: flex; gap: 14px; margin-top: 6px; font-size: 0.9em;}
    .treemap-item { display: flex; align-items: center;}
    .treemap-color { width: 18px; height: 18px; display: inline-block; margin-right: 5px; border-radius: 4px;}
    .chart-container { width: 310px; height: 110px; }
    .spark-container { width: 180px; height: 50px;}
    .spark-badge {
      font-size: 1em; 
      font-weight: 600;
      margin-left: 8px;
      padding: 4px 9px;
      border-radius: 8px;
      background: #222d48;
      border: 1px solid var(--line);
      position: relative;
      top: -4px;
    }
    .waterfall-list {
      font-size: 0.98em;
      margin: 8px 0 0 0;
      padding-left: 18px;
    }
    .waterfall-list li { margin-bottom: 3px; }
    .kpi-label { font-size: 1.18em; color: var(--muted);}
    .tooltip {
      font-size: 0.97em;
      background: #222d48;
      color: var(--text);
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid var(--line);
      margin-top: 8px;
      display: inline-block;
      max-width: 340px;
    }
    .pill-bars { display: flex; gap: 4px; margin: 10px 0 0 0;}
    .pill-bar {
      height: 18px;
      border-radius: 8px;
      background: #272b44;
      flex: 1;
      position: relative;
      overflow: hidden;
      border: 1px solid var(--line);
      margin-bottom: 4px;
    }
    .pill-bar-fill {
      height: 100%; border-radius: 8px; position: absolute; top: 0; left: 0;
    }
    .pill-br { background: var(--good);}
    .pill-rl { background: var(--bad);}
    .pill-sti { background: var(--warn);}
    .pill-tenure { background: var(--accent);}
    .pill-eq { background: var(--elite);}
    @media (max-width: 900px) {
      .row { flex-direction: column; }
      .chart-container, .spark-container { width: 100%; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>BundleBench: Demo Snapshot</h1>
    <div class="row">
      <!-- BenchScore (gauge) -->
      <section class="tile">
        <h3>BenchScore™</h3>
        <canvas id="benchscoreGauge" width="105" height="105"></canvas>
        <div class="kpi" id="benchscoreVal">76</div>
        <span class="badge good">Healthy</span>
        <div class="pill-bars">
          <div class="pill-bar"><div class="pill-bar-fill pill-br" style="width:65%;"></div></div>
          <div class="pill-bar"><div class="pill-bar-fill pill-rl" style="width:80%;"></div></div>
          <div class="pill-bar"><div class="pill-bar-fill pill-sti" style="width:62%;"></div></div>
          <div class="pill-bar"><div class="pill-bar-fill pill-tenure" style="width:70%;"></div></div>
          <div class="pill-bar"><div class="pill-bar-fill pill-eq" style="width:90%;"></div></div>
        </div>
        <div class="tooltip">
          0–100 composite of Bundling Rate, RL, STI, Retention, and Experience Quality.
        </div>
      </section>
      <!-- Time-Back Number (KPI + Waterfall) -->
      <section class="tile">
        <h3>Time-Back Number™</h3>
        <div class="kpi" id="tbnKpi">42</div>
        <span class="badge elite">Gold</span>
        <div class="kpi-label">Monthly hours reclaimable (Top‑12 split)</div>
        <ul class="waterfall-list">
          <li>Touch delta (unbundled vs bundled): <b>18 hrs</b></li>
          <li>Remarkets avoided: <b>14 hrs</b></li>
          <li>Cross-carrier admin saved: <b>10 hrs</b></li>
        </ul>
        <div class="tooltip">
          Estimated monthly hours saved if we convert your Top-N split accounts to bundled, using assumptions or measured time.
        </div>
      </section>
      <!-- Coverage Depth (stacked bar) -->
      <section class="tile">
        <h3>Coverage Depth</h3>
        <div class="viz">
          <div class="stacked-bar" id="coverageBar">
            <div class="bar-bundled" style="width:51%;"></div>
            <div class="bar-multiline" style="width:19%;"></div>
            <div class="bar-single" style="width:30%;"></div>
            <div class="bar-umbrella" style="width:28%;"></div>
            <div class="target-band" style="border:2px solid var(--good);left:50%;width:14%;"></div>
          </div>
        </div>
        <div>
          <span class="badge good">Healthy</span>
          <span style="margin-left:10px;">Umbrella: <b>22%</b></span>
        </div>
        <div class="tooltip">
          % of active households with ≥2 lines or bundled with same carrier. Umbrella and key endorsements increase quality of depth.
        </div>
      </section>
    </div>
    <div class="row">
      <!-- RL (run chart) -->
      <section class="tile">
        <h3>Remarketing Load</h3>
        <div class="chart-container"><canvas id="rlRunChart"></canvas></div>
        <span class="badge warn">Manageable</span>
        <div class="tooltip">
          Remarket events per 100 renewals this period. Lower is better.
        </div>
      </section>
      <!-- STI (bullet) -->
      <section class="tile">
        <h3>Service Touch Index</h3>
        <div class="chart-container"><canvas id="stiBullet"></canvas></div>
        <span class="badge warn">Heavy</span>
        <div class="tooltip">
          Total service minutes per household per year. From logged touches or touches × avg minutes.
        </div>
      </section>
      <!-- Tenure Momentum (sparkline) -->
      <section class="tile">
        <h3>Tenure Momentum</h3>
        <div class="spark-container"><canvas id="tenureSpark"></canvas></div>
        <span class="spark-badge" id="tenureRate">+0.28 yrs/yr <span style="color:var(--good)">▲</span></span>
        <div class="tooltip">
          Month-over-month change in average tenure (annualized), weighted by depth/bundled.
        </div>
      </section>
    </div>
    <div class="row">
      <!-- Coverage Depth Secondary: Waffle, Treemap -->
      <section class="tile" style="min-width:320px;flex:2;">
        <h3>Coverage Depth: Secondary Views</h3>
        <div>
          <div class="waffle" id="waffle"></div>
          <div style="margin:10px 0 6px 0; font-size:0.98em;">Waffle: Each square = 1% of households</div>
        </div>
        <div>
          <canvas id="treemap" width="300" height="110"></canvas>
          <div class="treemap-legend" id="treemapLegend"></div>
        </div>
      </section>
      <!-- RL Secondary: Pareto Bar -->
      <section class="tile">
        <h3>Top Remarket Reasons (Pareto)</h3>
        <div class="chart-container"><canvas id="rlPareto"></canvas></div>
        <div class="tooltip">
          Pareto bar of top remarket reasons.
        </div>
      </section>
      <!-- STI Secondary: Box by Channel -->
      <section class="tile">
        <h3>Service Minutes by Channel</h3>
        <div class="chart-container"><canvas id="stiBox"></canvas></div>
        <div class="tooltip">
          Box/violin by channel (phone/email/text/portal) to see where minutes pile up.
        </div>
      </section>
    </div>
    <footer style="text-align:center;color:var(--muted);font-size:0.96em;margin-top:24px;">
      Demo snapshot for BundleBench. No real agency data. For layout and metric illustration only.
    </footer>
  </div>
  <script>
    // ====== Demo Data ======
    // Coverage Depth: 51% bundled, 19% multi-line, 30% single; umbrella 22% (on bundled+multi)
    // RL: [28,25,19,15,12,13,19,20,18,16,17,14] per month
    // STI: current 89 min/HH/year, target 75
    // Tenure: sparkline [4.9,5.0,5.1,5.1,5.2,5.3,5.28,5.4,5.43,5.45,5.48,5.51]
    // RL Pareto: [rate ↑, appetite change, UW doc, price, carrier exit]
    // STI by channel: phone=93, email=48, text=21, portal=35

    // BenchScore Gauge
    let benchGauge = new Chart(document.getElementById('benchscoreGauge').getContext('2d'), {
      type: 'doughnut',
      data: {
        datasets: [{
          data: [76, 24],
          backgroundColor: ['#10b981','#222d48'],
          borderWidth: 5,
        }]
      },
      options: {
        cutout: '70%',
        plugins: {legend:{display:false},tooltip:{enabled:false}},
      }
    });
    // Coverage Depth Stacked Bar
    (() => {
      let bundled = 51, multiline = 19, single = 30, umbrella = 22;
      let bar = document.getElementById('coverageBar');
      let total = bundled+multiline+single;
      bar.children[0].style.width = (bundled/total*100)+'%';
      bar.children[1].style.width = (multiline/total*100)+'%';
      bar.children[2].style.width = (single/total*100)+'%';
      bar.children[3].style.width = ((umbrella/total*100)+'%');
      bar.children[4].style.left = "50%";
      bar.children[4].style.width = "14%";
    })();
    // RL Run Chart
    new Chart(document.getElementById('rlRunChart').getContext('2d'), {
      type: 'line',
      data: {
        labels: ['Oct','Nov','Dec','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep'],
        datasets: [{
          label: 'RL',
          data: [28,25,19,15,12,13,19,20,18,16,17,14],
          borderColor: '#f59e0b',
          backgroundColor: '#f59e0b22',
          pointRadius: 3,
          tension: 0.28,
          fill: true,
        }]
      },
      options: {
        plugins: {
          legend: {display: false},
        },
        scales: {
          y: {min: 0, max: 40, grid:{color:'#222d48'}, ticks:{color:'#cbd5e1'}}
        }
      }
    });
    // STI Bullet Chart
    (() => {
      const ctx = document.getElementById('stiBullet').getContext('2d');
      ctx.clearRect(0,0,310,110);
      // Background Bands
      ctx.fillStyle = "#ef4444"; ctx.fillRect(16,40,64,28);
      ctx.fillStyle = "#f59e0b"; ctx.fillRect(80,40,56,28);
      ctx.fillStyle = "#10b981"; ctx.fillRect(136,40,56,28);
      ctx.fillStyle = "#6366f1"; ctx.fillRect(192,40,70,28);
      // Target line
      ctx.strokeStyle = "#fff"; ctx.lineWidth=2;
      ctx.beginPath(); ctx.moveTo(136,40); ctx.lineTo(136,68); ctx.stroke();
      // Current Value Bar
      ctx.fillStyle = "#f59e0b";
      ctx.fillRect(16,54,105,14); // 89/210
      ctx.font = "bold 1.15em Inter";
      ctx.fillStyle="#fff";
      ctx.fillText("89 min", 16, 36);
      ctx.fillStyle="#94a3b8";
      ctx.font="0.9em Inter";
      ctx.fillText("Target: 75", 192, 36);
    })();
    // Tenure Momentum Sparkline
    (() => {
      const tenure = [4.9,5.0,5.1,5.1,5.2,5.3,5.28,5.4,5.43,5.45,5.48,5.51];
      const ctx = document.getElementById('tenureSpark').getContext('2d');
      new Chart(ctx, {
        type:'line',
        data:{
          labels:Array.from({length:tenure.length},(_,i)=>''),
          datasets:[{data:tenure, borderColor:'#10b981',backgroundColor:'#10b98144',pointRadius:2,fill:true,tension:0.18}]
        },
        options:{
          plugins:{legend:{display:false}},
          scales:{y:{display:false},x:{display:false}}
        }
      });
      document.getElementById('tenureRate').innerHTML = "+0.28 yrs/yr <span style='color:var(--good)'>▲</span>";
    })();
    // Coverage Depth Secondary: Waffle
    (() => {
      let bundled = 51, multiline = 19, single = 30, umbrella=22;
      let waffle = document.getElementById('waffle');
      let tiles = [];
      for(let i=0;i<51;i++) tiles.push(`<div class="waffle-tile waffle-bundled${i<umbrella?' waffle-umbrella':''}"></div>`);
      for(let i=0;i<19;i++) tiles.push(`<div class="waffle-tile waffle-multiline"></div>`);
      for(let i=0;i<30;i++) tiles.push(`<div class="waffle-tile waffle-single"></div>`);
      waffle.innerHTML = tiles.join('');
    })();
    // Coverage Depth Secondary: Treemap
    (() => {
      const carrierData = [
        {carrier:"Carrier A", value:31, color:"#6366f1"},
        {carrier:"Carrier B", value:13, color:"#10b981"},
        {carrier:"Carrier C", value:18, color:"#f59e0b"},
        {carrier:"Carrier D", value:8, color:"#ef4444"},
        {carrier:"Carrier E", value:30, color:"#94a3b8"}
      ];
      new Chart(document.getElementById('treemap').getContext('2d'),{
        type:'treemap',
        data:{
          datasets:[{
            tree: carrierData.map(c=>({v:c.value, carrier:c.carrier, color:c.color})),
            key:'v',
            groups:['carrier'],
            backgroundColor: ctx => ctx.raw.color
          }]
        },
        options:{
          plugins:{legend:{display:false}},
        }
      });
      let legend = carrierData.map(c=>`<span class="treemap-item"><span class="treemap-color" style="background:${c.color}"></span>${c.carrier}</span>`);
      document.getElementById('treemapLegend').innerHTML = legend.join('');
    })();
    // RL Secondary: Pareto Bar
    new Chart(document.getElementById('rlPareto').getContext('2d'), {
      type: 'bar',
      data: {
        labels: ['Rate ↑','Appetite','UW Docs','Price','Carrier Exit'],
        datasets: [{
          data: [47, 28, 18, 11, 8],
          backgroundColor: ['#f59e0b','#10b981','#6366f1','#ef4444','#94a3b8'],
          borderRadius: 7,
        }]
      },
      options: {
        plugins:{legend:{display:false}},
        indexAxis: 'y',
        scales:{x:{display:false},y:{grid:{color:'#222d48'}, ticks:{color:'#cbd5e1'}}}
      }
    });
    // STI Secondary: Box/Violin by Channel
    new Chart(document.getElementById('stiBox').getContext('2d'), {
      type: 'bar',
      data: {
        labels: ['Phone','Email','Text','Portal'],
        datasets: [{
          label:'Minutes',
          data:[93,48,21,35],
          backgroundColor: ['#f59e0b','#10b981','#6366f1','#ef4444'],
          borderRadius: 7,
        }]
      },
      options: {
        plugins:{legend:{display:false}},
        scales:{y:{grid:{color:'#222d48'},ticks:{color:'#cbd5e1'}}}
      }
    });
  </script>
</body>
</html>
